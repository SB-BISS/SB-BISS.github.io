{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.info = info;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _util2 = require(\"../util\"); // Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nconst UNDEF_HEX = {\n  toHex: () => undefined\n};\n\nfunction dataAsString(data) {\n  return data.isRaw ? (0, _util.u8aToString)(data.asRaw.toU8a(true)) : data.isNone ? undefined : data.toHex();\n}\n\nfunction retrieveNick(api, accountId) {\n  var _api$query$nicks;\n\n  return (accountId && ((_api$query$nicks = api.query.nicks) === null || _api$query$nicks === void 0 ? void 0 : _api$query$nicks.nameOf) ? api.query.nicks.nameOf(accountId) : (0, _rxjs.of)(undefined)).pipe((0, _operators.map)(nameOf => (nameOf === null || nameOf === void 0 ? void 0 : nameOf.isSome) ? (0, _util.u8aToString)(nameOf.unwrap()[0]).substr(0, api.consts.nicks.maxLength.toNumber()) : undefined));\n}\n\nfunction extractOther(additional) {\n  return additional.reduce((other, [_key, _value]) => {\n    const key = dataAsString(_key);\n    const value = dataAsString(_value);\n\n    if (key && value) {\n      other[key] = value;\n    }\n\n    return other;\n  }, {});\n}\n\nfunction extractIdentity(identityOfOpt, superOf) {\n  if (!(identityOfOpt === null || identityOfOpt === void 0 ? void 0 : identityOfOpt.isSome)) {\n    return {\n      judgements: []\n    };\n  }\n\n  const {\n    info,\n    judgements\n  } = identityOfOpt.unwrap();\n  const topDisplay = dataAsString(info.display);\n  return {\n    display: superOf && dataAsString(superOf[1]) || topDisplay,\n    displayParent: superOf && topDisplay,\n    email: dataAsString(info.email),\n    image: dataAsString(info.image),\n    judgements,\n    legal: dataAsString(info.legal),\n    other: extractOther(info.additional),\n    parent: superOf && superOf[0],\n    pgp: info.pgpFingerprint.unwrapOr(UNDEF_HEX).toHex(),\n    riot: dataAsString(info.riot),\n    twitter: dataAsString(info.twitter),\n    web: dataAsString(info.web)\n  };\n}\n\nfunction retrieveIdentity(api, accountId) {\n  var _api$query$identity;\n\n  return (accountId && ((_api$query$identity = api.query.identity) === null || _api$query$identity === void 0 ? void 0 : _api$query$identity.identityOf) ? api.queryMulti([[api.query.identity.identityOf, accountId], [api.query.identity.superOf, accountId]]) : (0, _rxjs.of)([undefined, undefined])).pipe((0, _operators.switchMap)(([identityOfOpt, superOfOpt]) => {\n    if (identityOfOpt === null || identityOfOpt === void 0 ? void 0 : identityOfOpt.isSome) {\n      // this identity has something set\n      return (0, _rxjs.of)([identityOfOpt, undefined]);\n    } else if (superOfOpt === null || superOfOpt === void 0 ? void 0 : superOfOpt.isSome) {\n      const superOf = superOfOpt.unwrap(); // we have a super\n\n      return (0, _rxjs.combineLatest)([api.query.identity.identityOf(superOf[0]), (0, _rxjs.of)(superOf)]);\n    } // nothing of value returned\n\n\n    return (0, _rxjs.of)([undefined, undefined]);\n  }), (0, _operators.map)(([identityOfOpt, superOf]) => extractIdentity(identityOfOpt, superOf)));\n}\n/**\n * @name info\n * @description Returns aux. info with regards to an account, current that includes the accountId, accountIndex and nickname\n */\n\n\nfunction info(instanceId, api) {\n  return (0, _util2.memo)(instanceId, address => api.derive.accounts.idAndIndex(address).pipe((0, _operators.switchMap)(([accountId, accountIndex]) => (0, _rxjs.combineLatest)([(0, _rxjs.of)({\n    accountId,\n    accountIndex\n  }), retrieveIdentity(api, accountId), retrieveNick(api, accountId)])), (0, _operators.map)(([{\n    accountId,\n    accountIndex\n  }, identity, nickname]) => ({\n    accountId,\n    accountIndex,\n    identity,\n    nickname\n  }))));\n}","map":{"version":3,"sources":["/home/tmaltus/Documents/BlockChainProjects/dotNetworkBlockInfo/node_modules/@polkadot/api-derive/accounts/info.js"],"names":["Object","defineProperty","exports","value","info","_rxjs","require","_operators","_util","_util2","UNDEF_HEX","toHex","undefined","dataAsString","data","isRaw","u8aToString","asRaw","toU8a","isNone","retrieveNick","api","accountId","_api$query$nicks","query","nicks","nameOf","of","pipe","map","isSome","unwrap","substr","consts","maxLength","toNumber","extractOther","additional","reduce","other","_key","_value","key","extractIdentity","identityOfOpt","superOf","judgements","topDisplay","display","displayParent","email","image","legal","parent","pgp","pgpFingerprint","unwrapOr","riot","twitter","web","retrieveIdentity","_api$query$identity","identity","identityOf","queryMulti","switchMap","superOfOpt","combineLatest","instanceId","memo","address","derive","accounts","idAndIndex","accountIndex","nickname"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.info = info;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _util2 = require(\"../util\");\n\n// Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nconst UNDEF_HEX = {\n  toHex: () => undefined\n};\n\nfunction dataAsString(data) {\n  return data.isRaw ? (0, _util.u8aToString)(data.asRaw.toU8a(true)) : data.isNone ? undefined : data.toHex();\n}\n\nfunction retrieveNick(api, accountId) {\n  var _api$query$nicks;\n\n  return (accountId && ((_api$query$nicks = api.query.nicks) === null || _api$query$nicks === void 0 ? void 0 : _api$query$nicks.nameOf) ? api.query.nicks.nameOf(accountId) : (0, _rxjs.of)(undefined)).pipe((0, _operators.map)(nameOf => (nameOf === null || nameOf === void 0 ? void 0 : nameOf.isSome) ? (0, _util.u8aToString)(nameOf.unwrap()[0]).substr(0, api.consts.nicks.maxLength.toNumber()) : undefined));\n}\n\nfunction extractOther(additional) {\n  return additional.reduce((other, [_key, _value]) => {\n    const key = dataAsString(_key);\n    const value = dataAsString(_value);\n\n    if (key && value) {\n      other[key] = value;\n    }\n\n    return other;\n  }, {});\n}\n\nfunction extractIdentity(identityOfOpt, superOf) {\n  if (!(identityOfOpt === null || identityOfOpt === void 0 ? void 0 : identityOfOpt.isSome)) {\n    return {\n      judgements: []\n    };\n  }\n\n  const {\n    info,\n    judgements\n  } = identityOfOpt.unwrap();\n  const topDisplay = dataAsString(info.display);\n  return {\n    display: superOf && dataAsString(superOf[1]) || topDisplay,\n    displayParent: superOf && topDisplay,\n    email: dataAsString(info.email),\n    image: dataAsString(info.image),\n    judgements,\n    legal: dataAsString(info.legal),\n    other: extractOther(info.additional),\n    parent: superOf && superOf[0],\n    pgp: info.pgpFingerprint.unwrapOr(UNDEF_HEX).toHex(),\n    riot: dataAsString(info.riot),\n    twitter: dataAsString(info.twitter),\n    web: dataAsString(info.web)\n  };\n}\n\nfunction retrieveIdentity(api, accountId) {\n  var _api$query$identity;\n\n  return (accountId && ((_api$query$identity = api.query.identity) === null || _api$query$identity === void 0 ? void 0 : _api$query$identity.identityOf) ? api.queryMulti([[api.query.identity.identityOf, accountId], [api.query.identity.superOf, accountId]]) : (0, _rxjs.of)([undefined, undefined])).pipe((0, _operators.switchMap)(([identityOfOpt, superOfOpt]) => {\n    if (identityOfOpt === null || identityOfOpt === void 0 ? void 0 : identityOfOpt.isSome) {\n      // this identity has something set\n      return (0, _rxjs.of)([identityOfOpt, undefined]);\n    } else if (superOfOpt === null || superOfOpt === void 0 ? void 0 : superOfOpt.isSome) {\n      const superOf = superOfOpt.unwrap(); // we have a super\n\n      return (0, _rxjs.combineLatest)([api.query.identity.identityOf(superOf[0]), (0, _rxjs.of)(superOf)]);\n    } // nothing of value returned\n\n\n    return (0, _rxjs.of)([undefined, undefined]);\n  }), (0, _operators.map)(([identityOfOpt, superOf]) => extractIdentity(identityOfOpt, superOf)));\n}\n/**\n * @name info\n * @description Returns aux. info with regards to an account, current that includes the accountId, accountIndex and nickname\n */\n\n\nfunction info(instanceId, api) {\n  return (0, _util2.memo)(instanceId, address => api.derive.accounts.idAndIndex(address).pipe((0, _operators.switchMap)(([accountId, accountIndex]) => (0, _rxjs.combineLatest)([(0, _rxjs.of)({\n    accountId,\n    accountIndex\n  }), retrieveIdentity(api, accountId), retrieveNick(api, accountId)])), (0, _operators.map)(([{\n    accountId,\n    accountIndex\n  }, identity, nickname]) => ({\n    accountId,\n    accountIndex,\n    identity,\n    nickname\n  }))));\n}"]},"metadata":{},"sourceType":"script"}